<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Turn an arbitrary string into unformatted HTML."><meta name="keywords" content="rust, rustlang, rust-lang, clean_text"><title>clean_text in ammonia - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../ammonia/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../ammonia/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><div class="sidebar-elems"><h2 class="location"><a href="index.html">In ammonia</a></h2></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../ammonia/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn"><span class="in-band">Function <a href="index.html">ammonia</a>::<wbr><a class="fn" href="#">clean_text</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/ammonia/lib.rs.html#129-166">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust fn"><code>pub fn clean_text(src: &amp;<a class="primitive" href="https://doc.rust-lang.org/1.65.0/std/primitive.str.html">str</a>) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.65.0/alloc/string/struct.String.html" title="struct alloc::string::String">String</a></code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Turn an arbitrary string into unformatted HTML.</p>
<p>This function is roughly equivalent to PHP’s <code>htmlspecialchars</code> and <code>htmlentities</code>.
It is as strict as possible, encoding every character that has special meaning to the
HTML parser.</p>
<h2 id="warnings"><a href="#warnings">Warnings</a></h2>
<p>This function cannot be used to package strings into a <code>&lt;script&gt;</code> or <code>&lt;style&gt;</code> tag;
you need a JavaScript or CSS escaper to do that.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// DO NOT DO THIS
</span><span class="kw">let </span>untrusted = <span class="string">&quot;Robert\&quot;); abuse();//&quot;</span>;
<span class="kw">let </span>html = <span class="macro">format!</span>(<span class="string">&quot;&lt;script&gt;invoke(\&quot;{}\&quot;)&lt;/script&gt;&quot;</span>, clean_text(untrusted));</code></pre></div>
<p><code>&lt;textarea&gt;</code> tags will strip the first newline, if present, even if that newline is encoded.
If you want to build an editor that works the way most folks expect them to, you should put a
newline at the beginning of the tag, like this:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>untrusted = <span class="string">&quot;\n\nhi!&quot;</span>;
<span class="kw">let </span><span class="kw-2">mut </span>b = Builder::new();
b.add_tags(<span class="kw-2">&amp;</span>[<span class="string">&quot;textarea&quot;</span>]);
<span class="comment">// This is the bad version
// The user put two newlines at the beginning, but the first one was removed
</span><span class="kw">let </span>sanitized = b.clean(<span class="kw-2">&amp;</span><span class="macro">format!</span>(<span class="string">&quot;&lt;textarea&gt;{}&lt;/textarea&gt;&quot;</span>, clean_text(untrusted))).to_string();
<span class="macro">assert_eq!</span>(<span class="string">&quot;&lt;textarea&gt;\nhi!&lt;/textarea&gt;&quot;</span>, sanitized);
<span class="comment">// This is a good version
// The user put two newlines at the beginning, and we add a third one,
// so the result still has two
</span><span class="kw">let </span>sanitized = b.clean(<span class="kw-2">&amp;</span><span class="macro">format!</span>(<span class="string">&quot;&lt;textarea&gt;\n{}&lt;/textarea&gt;&quot;</span>, clean_text(untrusted))).to_string();
<span class="macro">assert_eq!</span>(<span class="string">&quot;&lt;textarea&gt;\n\nhi!&lt;/textarea&gt;&quot;</span>, sanitized);
<span class="comment">// This version is also often considered good
// For many applications, leading and trailing whitespace is probably unwanted
</span><span class="kw">let </span>sanitized = b.clean(<span class="kw-2">&amp;</span><span class="macro">format!</span>(<span class="string">&quot;&lt;textarea&gt;{}&lt;/textarea&gt;&quot;</span>, clean_text(untrusted.trim()))).to_string();
<span class="macro">assert_eq!</span>(<span class="string">&quot;&lt;textarea&gt;hi!&lt;/textarea&gt;&quot;</span>, sanitized);</code></pre></div>
<p>It also does not make user text safe for HTML attribute microsyntaxes such as <code>class</code> or <code>id</code>.
Only use this function for places where HTML accepts unrestricted text such as <code>title</code> attributes
and paragraph contents.</p>
</div></details></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="ammonia" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.65.0 (897e37553 2022-11-02)" ></div></body></html>