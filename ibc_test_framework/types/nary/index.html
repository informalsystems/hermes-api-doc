<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Definitions for tagged data structures involving N-ary chains."><meta name="keywords" content="rust, rustlang, rust-lang, nary"><title>ibc_test_framework::types::nary - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-6d262342be62306e.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../../static.files/light-5f7299aa2b503fb1.css"><link rel="stylesheet" disabled href="../../../static.files/dark-dfb18ef8114bb428.css"><link rel="stylesheet" disabled href="../../../static.files/ayu-4047a6aaddd3789d.css"><script id="default-settings" ></script><script src="../../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../../static.files/main-3367e395607fafc1.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../ibc_test_framework/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../ibc_test_framework/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module nary</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">ibc_test_framework</a>::<wbr><a href="../index.html">types</a>::<wbr><a class="mod" href="#">nary</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/ibc_test_framework/types/nary/mod.rs.html#1-66">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Definitions for tagged data structures involving N-ary chains.</p>
<p>In the binary version of the tagged data structures, we use the
existential types <code>ChainA: ChainHandle</code> and <code>ChainB: ChainHandle</code>
to differentiate between two chains. Since Rust treat each type
differently, we can use <code>ChainA</code> and <code>ChainB</code> as type tags
to differentiate values coming from different chains.
For example, <code>DualTagged&lt;ChainA, ChainB, ChannelId&gt;</code>
can be used to refer to a <code>ChainId</code> on <code>ChainA</code> with the
counterparty chain being <code>ChainB</code>.</p>
<p>When extending to the N-ary case, we can no longer use
existential types to refer to each chain, because we cannot
know before hand how many types are needed. Instead,
we can use <em>const generics</em> to identify chains by <em>position</em>.</p>
<p>The first construct we need is the <a href="aliases/enum.Size.html"><code>Size</code></a> struct,
which lifts a const generic <code>usize</code> into a type:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">enum </span>Size&lt;<span class="kw">const </span>TAG: usize&gt; {}</code></pre></div>
<p>Using <code>Size</code>, we can for example use a <code>usize</code> as a tag.
For example, <code>MonoTagged&lt;Size&lt;42&gt;, String&gt;</code> is a <code>String</code>
that is tagged by the <code>usize</code> value <code>42</code>.</p>
<p>Aside from the position, we still need to be able to differentiate
values coming from different <em>collections</em> of chains. For example,
given a first collection <code>[ChainA, ChainB, ChainC]</code>, and a second
collection <code>[ChainD, ChainE]</code>, a naively position-tagged value like
<code>MonoTagged&lt;Size&lt;1&gt;, Denom&gt;</code> could be used to refer to a denomination
that come from either <code>ChainB</code> or <code>ChainE</code>, which defeats the purpose
of tagging values with type tags.</p>
<p>Due to the initial design of using the <code>ChainHandle</code> existential type as
the type tag, it is also required that any type that is used to tag
values for chains to also implement <code>ChainHandle</code>. Since <code>Size</code> does
not implement <code>ChainHandle</code>, it is also not possible to use it directly
as tags in structures such as <code>ForeignClient</code>.</p>
<p>Instead, we also require an existential <code>Collection: ChainHandle</code> type
to identify all chains within an N-ary collection. We then tag
the handle with the position, before tagging it again with the
values. For example, a <code>Denom</code> that is tagged with the third chain
in the first collection would be written as
<code>MonoTagged&lt;MonoTagged&lt;Size&lt;2&gt;, Collection1&gt;, Denom&gt;</code>.
The tagging also works because we have defined a <code>ChainHandle</code>
implementation for <code>MonoTagged&lt;Tag, Chain&gt;</code> for any <code>Chain: ChainHandle</code>.</p>
<p>The current approach for tagging N-ary chain values is a bit cumbersome.
To save the effort of typing the fully qualified type of N-ary tagged
values, we also define type aliases such as
<a href="aliases/type.NthChainHandle.html"><code>NthChainHandle</code></a> and
<a href="foreign_client/type.NthForeignClient.html"><code>NthForeignClient</code></a>.
This would still result in overly verbose messages in type errors involving
these types. If necessary, we will refactor these defintions as newtypes
so that they can be used and shown in a cleaner form.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="aliases/index.html" title="ibc_test_framework::types::nary::aliases mod">aliases</a></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="chains/index.html" title="ibc_test_framework::types::nary::chains mod">chains</a></div><div class="item-right docblock-short">Constructs for N-ary connected chains.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="channel/index.html" title="ibc_test_framework::types::nary::channel mod">channel</a></div><div class="item-right docblock-short">Constructs for N-ary connected channels.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="connection/index.html" title="ibc_test_framework::types::nary::connection mod">connection</a></div><div class="item-right docblock-short">Constructs for N-ary connected connections.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="foreign_client/index.html" title="ibc_test_framework::types::nary::foreign_client mod">foreign_client</a></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="ibc_test_framework" data-themes="" data-resource-suffix="" data-rustdoc-version="1.69.0-nightly (c18a5e8a5 2023-01-25)" data-search-js="search-98d53477a794af0b.js" data-settings-js="settings-a43118d2dfb2799d.js" data-settings-css="settings-7c23ac01f615ce90.css" ></div></body></html>